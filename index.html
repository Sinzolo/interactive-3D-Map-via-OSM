<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <title>Interactive 3D Map via OSM</title>
    <link rel="icon" href="icons/favicon.png">
    <!-- <link rel="prefetch" href="rasterWorker.js" as="worker"> -->
    <!-- <link rel="prefetch" href="fetchWorker.js" as="worker"> -->
    <!-- <link rel="preload" href="geotiff.js.map"> -->

    <script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@hughsk/fulltilt@0.7.1/dist/fulltilt.min.js"></script>
    <!-- <script src="aframe.min.js"></script> -->
    <script src="simple-sun-sky.min.js"></script>
    <script defer src="osmtogeojson.min.js"></script>   <!-- OSM to GeoJSON converter -->
    <script defer src="geotiff.min.js"></script>    <!-- Tiff manipulator -->
    <script defer src="proj4.min.js"></script>  <!-- Coord converter -->
    <!-- <script defer src="https://cdn.jsdelivr.net/gh/diarmidmackenzie/instanced-mesh@v0.6.0/src/instanced-mesh.min.js"></script> -->
    <!-- <script defer src="https://unpkg.com/aframe-geometry-merger-component/dist/aframe-geometry-merger-component.min.js"></script> -->
    <!-- <script src="https://unpkg.com/aframe-extras/dist/aframe-extras.controls.min.js"></script>   -->
    <!-- <script src="https://unpkg.com/aframe-geometry-merger-component/dist/aframe-geometry-merger-component.min.js"></script>  Not sure what this is for-->


    <!-- <img id = "geotiff" src="uniTiff/SD45ne_DTM_2m.tif" class="hidden">
        <img id = "geotiff" src="cityTiff/SD46se_DTM_2m.tif" class="hidden">
        <img id = "geotiff" src="leylandTiff/SD52sw_DTM_2m.tif" class="hidden">
        <img id = "geotiff" src="lydiateTiff/SD51nw_DTM_2m.tif" class="hidden"> -->

    <script defer src="utilities.js"></script>
    <script defer src="conversions.js"></script>
    <script defer src="greenery.js"></script>
    <script defer src="terrain.js"></script>
    <script defer src="buildings.js"></script>
    <script defer src="DijkstrasAlgo.js"></script>
    <script defer src="paths.js"></script>
    <script defer src="navigation.js"></script>
    <script defer src="main.js"></script>
</head>

<body>
    <div id="welcomeScreen">
        <h2>Welcome to my Third Year Project for Lancaster University.</h2>
        <br>This website automatically generates a 3D map of the specified place using OSM's large database.
        <br><button id="loadMapBtn" onclick="uniMap(), showMap()">Load Uni Map</button>
        <br><button id="loadMapBtn" onclick="cityMap(), showMap()">Load City Map</button>
    </div>

    <div id="mapScreen" style="display: none">
        <button id="settings" onclick="toggleInterface()">
            <svg fill="none" height="16" viewBox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg">
                <path d="m2.26726 6.15309c.26172-.80594.69285-1.54574 1.26172-2.1727.09619-.10602.24711-.14381.38223-.0957l1.35948.484c.36857.13115.77413-.06004.90584-.42703.01295-.03609.02293-.07316.02982-.1108l.259-1.41553c.02575-.14074.13431-.25207.27484-.28186.41118-.08714.83276-.13146 1.25987-.13146.42685 0 .84818.04427 1.25912.1313.14049.02976.24904.14102.27485.28171l.25973 1.41578c.07022.38339.43924.63751.82434.5676.0379-.00688.0751-.01681.1113-.02969l1.3595-.48402c.1351-.04811.286-.01032.3822.0957.5689.62696 1 1.36676 1.2618 2.1727.0441.13596.0015.28502-.1079.3775l-1.1019.93152c-.2983.25225-.3348.69756-.0815.99463.0249.02921.0522.05635.0815.08114l1.1019.93153c.1094.09248.152.24154.1079.37751-.2618.80598-.6929 1.54578-1.2618 2.17268-.0962.106-.2471.1438-.3822.0957l-1.3595-.484c-.3685-.1311-.7741.0601-.90581.427-.01295.0361-.02293.0732-.02985.111l-.25971 1.4157c-.02581.1407-.13436.2519-.27485.2817-.41094.087-.83227.1313-1.25912.1313-.42711 0-.84869-.0443-1.25987-.1315-.14053-.0298-.24909-.1411-.27484-.2818l-.25899-1.4155c-.07022-.3834-.43928-.6375-.82433-.5676-.03787.0069-.0751.0168-.11128.0297l-1.35954.484c-.13512.0481-.28604.0103-.38223-.0957-.56887-.6269-1-1.3667-1.26172-2.17268-.04415-.13597-.00158-.28503.10783-.37751l1.1019-.93152c.29835-.25225.33484-.69756.08151-.99463-.02491-.02921-.05217-.05635-.0815-.08114l-1.10191-.93153c-.10941-.09248-.15198-.24154-.10783-.3775zm3.98268 1.84685c0 .9665.7835 1.75 1.75 1.75s1.75-.7835 1.75-1.75-.7835-1.75-1.75-1.75-1.75.7835-1.75 1.75z" fill="#212121"/>
            </svg>
        </button>
        <div id="interface" style="display: none">
            <button id="loadMenuBtn" onclick="hideNavigationMenu(), showMainMenu()">Load Menu</button>
            <button id="loadNavigationMenuBtn" onclick="showNavigationMenu()">Navigate</button>

            <!-- <br><button id="highQualityBtn" title="Better quality but worse performance" onclick="setLowQuality(false)">High
                Quality</button> -->
            <!-- <button id="lowQualityBtn" title="Better performance but worse quality" onclick="setLowQuality(true)">Low
                Quality</button> -->

            <div id="navigationScreen" style="display: none">
                <label>Destination:</label>
                <datalist id="placeNames">
                </datalist>
                <input id="placeInput" autoComplete="on" list="placeNames" placeholder="Place Name"/>
                <br>
                <input id="destinationLat" type="number" class="coords" placeholder="Latitude" step="0.00001" min="-90"
                    max="90" value="" required> /
                <input id="destinationLong" type="number" class="coords" placeholder="Longitude" step="0.00001" min="-180"
                    max="180" value="" required><br>
                <button id="startNavigationBtn">Go!</button>
                <button id="hideNavigationMenuBtn">Cancel</button>
            </div>
        </div>


        <div id="myModal" class="modal">
            <div class="modal-content">
                <span class="close">&times;</span>
                <p>Destination Reached!</p>
            </div>
        </div>
        <label id="loading" style="display: none">Loading</label>


        <a-scene id="scene" vr-mode-ui="enabled: true" background="color: #74d2fa" updatetopdowncam>
            <a-simple-sun-sky id="sun" sun-position="0.7 1 -1" light-color="#87cefa" dark-color="#00bfff"
                fog-color="#74d2fa"></a-simple-sun-sky>
            <a-entity light="type: ambient; color: #A8A8A8"></a-entity>
            <a-entity light="type: directional; color: #FFF; intensity: 0.8" position="0.7 1 -1"></a-entity>

            <div id="startAndStopSpheres"></div>

            <a-sphere id="playerSphere" color="#1040D0" radius="3" segments-width="15" segments-height="13"></a-sphere>
            <a-entity id="rig">
                <a-entity id="playerCamera" camera="active: true" look-controls position="0 0 0" rotation="0 0 0">
                    <a-entity>
                        <a-entity id="arrow" position="0 -0.4 -0.7" rotation="0 0 0"
                            geometry="primitive: cone; radiusTop: 0; radiusBottom: 0.06; height: 0.23" material="color: white" visible="false"></a-entity>
                    </a-entity>
                    </a-entity>
                <a-entity id="debugCamera" camera="active: false" look-controls
                    wasd-controls="acceleration: 500; fly: true"></a-entity>
            </a-entity>

            <a-entity id="secondaryRig" rotation="-90 0 0">
                <a-entity id="secondarycamera" camera="zoom: 3; active: false;"></a-entity>
            </a-entity>
        </a-scene>
        <canvas id="miniMap" width="100" height="100"></canvas>

    </div>
    
</body>

</html>