<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link async rel="stylesheet" href="style.css">
    <title>Interactive 3D Map via OSM</title>
    <link defer rel="icon" href="icons/favicon.png">

    <!-- <script defer src="https://cdn.jsdelivr.net/gh/diarmidmackenzie/instanced-mesh@v0.6.0/src/instanced-mesh.min.js"></script> -->
    <!-- <script defer src="https://unpkg.com/aframe-geometry-merger-component/dist/aframe-geometry-merger-component.min.js"></script> -->
    <script defer src="osmtogeojson.min.js"></script> <!-- OSM to GeoJSON converter -->
    <script defer src="geotiff.min.js"></script> <!-- Tiff manipulator -->
    <script defer src="proj4.min.js"></script> <!-- Coord converter -->
    <script defer src="utilities.js"></script>
    <script defer src="conversions.js"></script>
    <script defer src="greenery.js"></script>
    <script defer src="terrain.js"></script>
    <script defer src="buildings.js"></script>
    <script defer src="DijkstrasAlgo.js"></script>
    <script defer src="paths.js"></script>
    <script defer src="navigation.js"></script>
    <script defer src="main.js"></script>

    <script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
    <script src="simple-sun-sky.min.js"></script>
</head>

<body>
    <div id="welcomeScreen">
        <h2>Welcome to my Third Year Project for Lancaster University.</h2>
        <br>This website automatically generates a 3D map of the specified place using OSM's large database.
        <br><button id="loadMapBtn" onclick="uniMap(), showMap(), startCompass()">Start!</button>
        <!-- <br><button id="loadMapBtn" onclick="cityMap(), showMap()">Load City Map</button> -->
    </div>

    <div id="mapScreen" style="display: none">
        <button id="settings" onclick="toggleInterface()">
            <svg fill="#000000" version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg"
                xmlns:xlink="http://www.w3.org/1999/xlink" width="800px" height="800px" viewBox="0 0 24.75 24.75"
                xml:space="preserve">
                <g>
                    <path d="M0,3.875c0-1.104,0.896-2,2-2h20.75c1.104,0,2,0.896,2,2s-0.896,2-2,2H2C0.896,5.875,0,4.979,0,3.875z M22.75,10.375H2
            		c-1.104,0-2,0.896-2,2c0,1.104,0.896,2,2,2h20.75c1.104,0,2-0.896,2-2C24.75,11.271,23.855,10.375,22.75,10.375z M22.75,18.875H2
            		c-1.104,0-2,0.896-2,2s0.896,2,2,2h20.75c1.104,0,2-0.896,2-2S23.855,18.875,22.75,18.875z" />
                </g>
            </svg>
        </button>
        <div id="interface" style="display: none">
            <button id="centreCam" onclick="centreCamera = true">Centre</button>
            <br> <button id="loadNavigationMenuBtn" onclick="showNavigationMenu()">Navigate</button>
            <br> <button id="loadMenuBtn" onclick="hideNavigationMenu(), showMainMenu()">Load Menu</button>

            <!-- <br><button id="highQualityBtn" title="Better quality but worse performance" onclick="setLowQuality(false)">High
                Quality</button> -->
            <!-- <button id="lowQualityBtn" title="Better performance but worse quality" onclick="setLowQuality(true)">Low
                Quality</button> -->

            <div id="navigationScreen" style="display: none">
                <label>Destination:</label>
                <datalist id="placeNames">
                </datalist>
                <input id="placeInput" type="search" name="q" aria-label="Search for building/amenities for navigation." autocomplete="on" list="placeNames" placeholder="Place Name"/>
                <br>
                <input id="destinationLat" type="number" class="coords" placeholder="Latitude" step="0.00001" min="-90"
                    max="90" value="" required> /
                <input id="destinationLong" type="number" class="coords" placeholder="Longitude" step="0.00001" min="-180"
                    max="180" value="" required><br>
                <button id="startNavigationBtn">Go!</button>
                <button id="hideNavigationMenuBtn">Cancel</button>
            </div>
        </div>


        <div id="myModal" class="modal">
            <div class="modal-content">
                <span class="close">&times;</span>
                <p>Destination Reached!</p>
            </div>
        </div>
        <label id="loading" style="display: none">Loading</label>


        <a-scene id="scene" vr-mode-ui="enabled: true" background="color: #74d2fa" updatetopdowncam>
            <a-simple-sun-sky id="sun" sun-position="0.7 1 -1" light-color="#87cefa" dark-color="#00bfff"
                fog-color="#74d2fa"></a-simple-sun-sky>
            <a-entity light="type: ambient; color: #A8A8A8"></a-entity>
            <a-entity light="type: directional; color: #FFF; intensity: 0.8" position="0.7 1 -1"></a-entity>

            <div id="startAndStopSpheres"></div>

            <a-sphere id="playerSphere" color="#1040D0" radius="3" segments-width="15" segments-height="13"></a-sphere>
            <a-entity id="rig">
                <a-entity id="playerCamera" camera="active: true" look-controls="magicWindowTrackingEnabled: true; touchEnabled: true">
                    <a-entity>
                        <a-entity id="arrow" position="0 -0.4 -0.7" rotation="0 0 0"
                            geometry="primitive: cone; radiusTop: 0; radiusBottom: 0.06; height: 0.23" material="color: white" visible="false"></a-entity>
                    </a-entity>
                    </a-entity>
                <a-entity id="debugCamera" camera="active: false" look-controls
                    wasd-controls="acceleration: 500; fly: true"></a-entity>
            </a-entity>

            <a-entity id="secondaryRig" rotation="-90 0 0">
                <a-entity id="secondarycamera" camera="zoom: 3; active: false;"></a-entity>
            </a-entity>
        </a-scene>
        <canvas id="miniMap" width="100" height="100"></canvas>

    </div>

</body>

</html>